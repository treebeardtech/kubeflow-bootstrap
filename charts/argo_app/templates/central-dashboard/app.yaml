{{- if eq .Values.name "centraldashboard" }}
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: {{ .Values.name }}
  annotations:
    test: "test"
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  destination:
    namespace: kubeflow
    server: https://kubernetes.default.svc
  project: default
  source:
    path: {{ .Values.path }}
    repoURL: {{ .Values.repoURL }}
    targetRevision: {{ .Values.targetRevision }}
    kustomize:
      patches:
      - target:
          kind: ConfigMap
          name: centraldashboard-config
        patch: |-
          - op: replace
            path: /data/links
            value: |
              {
                "menuLinks": [
                  {
                    "type": "item",
                    "link": "/jupyter/",
                    "text": "Notebooks",
                    "icon": "book"
                  },
                  {
                    "type": "item",
                    "link": "/volumes/",
                    "text": "Volumes",
                    "icon": "device:storage"
                  }
                ],
                "externalLinks": [ ],
                  "quickLinks": [
                    {
                      "text": "Create a new Notebook server",
                      "desc": "Notebook Servers",
                      "link": "/jupyter/new?namespace=kubeflow"
                    }
                  ],
                  "documentationItems": [
                    {
                      "text": "Getting Started with Kubeflow",
                      "desc": "Get your machine-learning workflow up and running on Kubeflow",
                      "link": "https://www.kubeflow.org/docs/started/getting-started/"
                    }
                  ]
              }

operation:
  sync:
    syncStrategy:
      apply: {}
{{- end }}
